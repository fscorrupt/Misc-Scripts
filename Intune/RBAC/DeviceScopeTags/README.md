The original idea was from @scottbreenmsft

I built upon the script and optimized it.
